
if (NOT CJSON_DIRECTORY)
    message(FATAL_ERROR "CJSON_DIRECTORY is not set!")
endif()

set(CJSON_INCLUSION_DIRECTORY ${CMAKE_BINARY_DIR}/cJSON)

file(COPY ${CJSON_DIRECTORY}/cJSON.c DESTINATION ${CJSON_INCLUSION_DIRECTORY}/cjson)
file(COPY ${CJSON_DIRECTORY}/cJSON.h DESTINATION ${CJSON_INCLUSION_DIRECTORY}/cjson)

add_library(cjson SHARED ${CJSON_INCLUSION_DIRECTORY}/cjson/cJSON.c)

set(CJSON_BINARY_DYLIB ${CMAKE_BINARY_DIR}/libcjson${PLATFORM_DYLIB_ENDING})

add_library(CJSON INTERFACE)

target_include_directories(CJSON INTERFACE ${CJSON_INCLUSION_DIRECTORY})

target_link_libraries(CJSON INTERFACE ${CJSON_BINARY_DYLIB}.a)

install(FILES ${CJSON_BINARY_DYLIB} DESTINATION runtime/lib)