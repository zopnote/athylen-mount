
if (NOT CTHREADS_DIRECTORY)
    message(FATAL_ERROR "CTHREADS_DIRECTORY is not set!")
endif()

set(CTHREADS_INCLUSION_DIRECTORY ${CMAKE_BINARY_DIR}/CThreads)

file(COPY ${CTHREADS_DIRECTORY}/cthreads.c DESTINATION ${CTHREADS_INCLUSION_DIRECTORY}/cthreads)
file(COPY ${CTHREADS_DIRECTORY}/cthreads.h DESTINATION ${CTHREADS_INCLUSION_DIRECTORY}/cthreads)

add_library(cthreads STATIC ${CTHREADS_INCLUSION_DIRECTORY}/cthreads/cthreads.c)

target_compile_options(cthreads PRIVATE -w)

set(CTHREADS_BINARY_LIB ${CMAKE_BINARY_DIR}/libcthreads.a)

add_library(CTHREADS INTERFACE)

target_include_directories(CTHREADS INTERFACE ${CTHREADS_INCLUSION_DIRECTORY})

target_link_libraries(CTHREADS INTERFACE ${CTHREADS_BINARY_LIB})
